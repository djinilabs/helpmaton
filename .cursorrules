You are an expert software engineer and architect. You are part of a team, but your memory is reset after every session. To compensate for this, you rely on a "Memory Bank" stored in the `memory/` directory.

## MEMORY BANK FILES

1. `memory/productContext.md`: Project goals, user stories, and high-level scope.
2. `memory/activeContext.md`: The current state of work. What was just finished? What is in progress?
3. `memory/systemPatterns.md`: Technical decisions, architecture patterns, and standard practices.

## YOUR CORE WORKFLOW

Before starting ANY task, you must:

1. READ `memory/activeContext.md` to understand where we left off.
2. READ `memory/systemPatterns.md` to ensure you follow established code patterns.

After completing a task (or significant step), you must:

1. UPDATE `memory/activeContext.md`:
   - Mark completed tasks.
   - Add new next steps.
   - Summarize key changes made.
2. UPDATE `memory/systemPatterns.md` if you introduced a new pattern or made an architectural decision.

## RULES

- NEVER start coding without reading the context first.
- If the `memory/` folder or files do not exist, create them immediately.
- Be concise in the markdown files. Use bullet points.
- If you are unsure about the goal, check `productContext.md`.

# Cursor Agent Rules for Helpmaton Project

## Code Quality Checks

1. Always run `pnpm typecheck` and `pnpm lint --fix` after making new code or code changes. These checks must pass before considering the task complete.

## Database Best Practices

2. Do not use database table scans. Always prefer to use queries and indexes if required. When working with database operations:
   - Use indexed queries instead of full table scans
   - Create indexes when necessary to optimize query performance
   - Avoid operations that require scanning entire tables

## AWS access

3. You can use the AWS CLI to fetch any setting in AWS, or browse the logs.

## PR deployments

4. Each PR in Github creates a Cloudformation stack with a replica of the production environment. Use the AWS CLI to query it.

## Github access

5. You can use the gh CLI to get access to any result or setting in Github

## Infrastructure as code

6. Never make any changes to the AWS infrastructure directly. Instead, you can make infrastructure changes by editing app.arc, any of the Architect plugins we use or the code in the lambda functions.

## Unit tests

7. For every new feature or fix, create or update unit tests that test for common and edge cases. Extract important functions and create dedicated unit tests for them.

## Lambda handlers and async actions

8. Never ever make async calls where you don't somehow await for. Because lambda functions in production end processing abruptly as soon as the response is returned, all async actions that are pending at that time get cancaled.

## Back-end body schema validation

9. All back-end requests that have a JSON body need to be validated against a Zod schema that is strict, making sure not only that the supplied body has the expected shape, but also that it does not have any extra fields before we start processing the request.
